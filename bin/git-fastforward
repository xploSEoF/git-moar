#!/bin/bash

target=$1

if [ "$target" = "" ]; then
	branch=$(git name-rev --name-only HEAD)

	if [ "$branch" = "" ]; then
		echo "Cannot determine branch" >&2
		exit 1
	fi

	origin=`git config branch.$branch.remote` 

	if [ "$?" -ne 0 ]; then
		echo "Didn't find sensible default" >&2
		exit 1
	fi

	target="$origin/$branch"
fi

git merge --ff-only $target
